# Microscopy Image Classification Challenge

This repository contains code, data, and models for the **Microscopy Image Classification Challenge**. The project combines grayscale microscopy images (nucleus, microtubules, and endoplasmic reticulum) into RGB images and classifies them using the **EfficientNetB0** model. The dataset includes nine different cell line classes, and the project makes use of image processing techniques and deep learning for classification.

## Folder Structure

- **`.ipynb_checkpoints/`**: Jupyter notebook checkpoints.
- **`combined_data/`**: Directory containing combined RGB images used for training.
- **`combined_data_test/`**: Directory containing combined RGB images used for testing.
- **`images_test/`**: Grayscale images for the test dataset (before merging).
- **`images_train/`**: Grayscale images for the training dataset (before merging).
- **`efficientnet_model_epoch_7.pth`**: The trained EfficientNet model saved at epoch 7.
- **`K12343657_Challenge_4.ipynb`**: Jupyter notebook containing the main code for image preprocessing, model training, and prediction.
- **`predictions_efficientnet.csv`**: CSV file containing predictions generated by the EfficientNet model on the test dataset.
- **`sample_submission.csv`**: Sample format for submitting predictions.
- **`test_predictions.csv`**: Final test predictions generated from the model.
- **`y_train.csv`**: Training labels for the dataset.

## Objective

The goal of this project is to classify microscopy images into nine different cell line classes by first combining grayscale microscopy images into RGB images and then using a **pre-trained EfficientNetB0** model fine-tuned for classification.

## Data Preparation

Three grayscale images (nucleus, microtubules, and endoplasmic reticulum) are merged into a single RGB image. These merged images are then used for training and testing the classification model.

### Process:
1. **Loading Images**: Load the three grayscale images (nucleus, microtubules, and endoplasmic reticulum).
2. **Merging Images**: Merge the grayscale images into a single RGB image, where each grayscale image is assigned to one of the RGB channels.
3. **Saving Images**: Save the combined RGB images for use in training and testing.

## Data Loading

- **Resize**: The images are resized to 224x224 pixels to fit the pre-trained model's input requirements.
- **Normalization**: Normalization is applied to the images with the following mean and standard deviation: `mean: [0.485, 0.456, 0.406]`, `std: [0.229, 0.224, 0.225]`.
- **Data Split**: 
  - Training set: 80%
  - Validation set: 20%
- **Batch Size**: 32
- **Shuffling**: Enabled for the training set to ensure randomness.

## Model Setup

### Model Architecture

- **EfficientNetB0**: Pre-trained EfficientNetB0 was selected for its balance of efficiency and performance.
  - The final layer was replaced to match the number of cell line classes (9).
  
### Hyperparameters
- **Optimizer**: AdamW optimizer.
- **Learning Rate**: 1e-4.
- **Loss Function**: CrossEntropy.
- **Scheduler**: StepLR, with a step size of 7 and gamma of 0.1.
- **Epochs**: 10.

## Training the Model

The model was trained for 10 epochs. The best-performing model checkpoint was saved after **epoch 7**, as indicated by validation accuracy.

## Prediction and Results

- The model was loaded from the saved checkpoint (`efficientnet_model_epoch_7.pth`).
- Predictions were made on the test set, and the results were saved in `predictions_efficientnet.csv`.
- The test predictions include columns `file_id` and `cell_line`, representing the image ID and the predicted class for each image.

### Running the Jupyter Notebook
1. Clone the repository:
   ```bash
   git clone <repository-url>
   cd <repository-directory>
   ```

2. Open the Jupyter notebook:
   ```bash
   jupyter notebook K12343657_Challenge_4.ipynb
   ```

3. Run the cells to:
   - Preprocess the grayscale images.
   - Train the EfficientNetB0 model on the training set.
   - Make predictions on the test set.

## Results

- **Model**: EfficientNetB0
- **Best Epoch**: 7
- **Accuracy**: Achieved high accuracy on the test set with the combined RGB images.
- **Predictions**: Predictions are stored in `predictions_efficientnet.csv`.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for more information.

## Acknowledgments

- Thanks to the [EfficientNet](https://github.com/lukemelas/EfficientNet-PyTorch) implementation and the microscopy image dataset providers.